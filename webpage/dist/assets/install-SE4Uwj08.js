import{H,ah as De,ai as I,aj as Le,v as B,y as _,w as O,a0 as A,ak as vt,al as ct,am as $,S as ft,an as He,ap as xt,aq as dt,ar as ke,as as Ht,_ as P,q as Pe,ae as Ae,j as kt,X as j,m as Be,t as Ne,Z as ve,aa as Ee,a1 as Fe,at as Ge,a2 as Xe,C as ce,x as L,au as de,av as $e,aw as st,ax as We,I as Ye,ay as ge,az as ye,aA as Ue,aB as Ze,aC as U,aD as Ke,aE as qe,aF as Pt,aG as Qe,o as X,aH as je,aI as me,z as At,aJ as Je,aK as ti,aL as ei,aM as Bt,k as bt,aN as Nt,aO as ii,aP as ri,Q as Mt,V as Et,aQ as _e,aR as ai,P as Se,aS as it,aT as ni,aU as oi,aV as gt,u as Tt,aW as si,aX as li,aY as ui,aZ as hi,a_ as Ft,a$ as we,a3 as xe,b0 as fi,b1 as nt,G as lt,a7 as Gt,e as Ct,b2 as It,b3 as pi,b4 as vi,b5 as yt,b6 as mt,b7 as ci,b8 as di,b9 as gi,R as yi,ba as Xt,bb as mi,bc as _i}from"./install-Z3eddXWy.js";var J=_,Si=B,ut=-1,zt=function(){function n(e){var t=e.mappingMethod,i=e.type,r=this.option=H(e);this.type=i,this.mappingMethod=t,this._normalizeData=bi[t];var a=n.visualHandlers[i];this.applyVisual=a.applyVisual,this.getColorMapper=a.getColorMapper,this._normalizedToVisual=a._normalizedToVisual[t],t==="piecewise"?(_t(r),wi(r)):t==="category"?r.categories?xi(r):_t(r,!0):(De(t!=="linear"||r.dataExtent),_t(r))}return n.prototype.mapValueToVisual=function(e){var t=this._normalizeData(e);return this._normalizedToVisual(t,e)},n.prototype.getNormalizer=function(){return I(this._normalizeData,this)},n.listVisualTypes=function(){return Le(n.visualHandlers)},n.isValidType=function(e){return n.visualHandlers.hasOwnProperty(e)},n.eachVisual=function(e,t,i){B(e)?_(e,t,i):t.call(i,e)},n.mapVisual=function(e,t,i){var r,a=O(e)?[]:B(e)?{}:(r=!0,null);return n.eachVisual(e,function(o,s){var l=t.call(i,o,s);r?a=l:a[s]=l}),a},n.retrieveVisuals=function(e){var t={},i;return e&&J(n.visualHandlers,function(r,a){e.hasOwnProperty(a)&&(t[a]=e[a],i=!0)}),i?t:null},n.prepareVisualTypes=function(e){if(O(e))e=e.slice();else if(Si(e)){var t=[];J(e,function(i,r){t.push(r)}),e=t}else return[];return e.sort(function(i,r){return r==="color"&&i!=="color"&&i.indexOf("color")===0?1:-1}),e},n.dependsOn=function(e,t){return t==="color"?!!(e&&e.indexOf(t)===0):e===t},n.findPieceIndex=function(e,t,i){for(var r,a=1/0,o=0,s=t.length;o<s;o++){var l=t[o].value;if(l!=null){if(l===e||A(l)&&l===e+"")return o;i&&p(l,o)}}for(var o=0,s=t.length;o<s;o++){var h=t[o],f=h.interval,u=h.close;if(f){if(f[0]===-1/0){if(at(u[1],e,f[1]))return o}else if(f[1]===1/0){if(at(u[0],f[0],e))return o}else if(at(u[0],f[0],e)&&at(u[1],e,f[1]))return o;i&&p(f[0],o),i&&p(f[1],o)}}if(i)return e===1/0?t.length-1:e===-1/0?0:r;function p(v,c){var d=Math.abs(v-e);d<a&&(a=d,r=c)}},n.visualHandlers={color:{applyVisual:K("color"),getColorMapper:function(){var e=this.option;return I(e.mappingMethod==="category"?function(t,i){return!i&&(t=this._normalizeData(t)),Q.call(this,t)}:function(t,i,r){var a=!!r;return!i&&(t=this._normalizeData(t)),r=vt(t,e.parsedVisual,r),a?r:ct(r,"rgba")},this)},_normalizedToVisual:{linear:function(e){return ct(vt(e,this.option.parsedVisual),"rgba")},category:Q,piecewise:function(e,t){var i=Ot.call(this,t);return i==null&&(i=ct(vt(e,this.option.parsedVisual),"rgba")),i},fixed:G}},colorHue:rt(function(e,t){return dt(e,t)}),colorSaturation:rt(function(e,t){return dt(e,null,t)}),colorLightness:rt(function(e,t){return dt(e,null,null,t)}),colorAlpha:rt(function(e,t){return ke(e,t)}),decal:{applyVisual:K("decal"),_normalizedToVisual:{linear:null,category:Q,piecewise:null,fixed:null}},opacity:{applyVisual:K("opacity"),_normalizedToVisual:Vt([0,1])},liftZ:{applyVisual:K("liftZ"),_normalizedToVisual:{linear:G,category:G,piecewise:G,fixed:G}},symbol:{applyVisual:function(e,t,i){var r=this.mapValueToVisual(e);i("symbol",r)},_normalizedToVisual:{linear:$t,category:Q,piecewise:function(e,t){var i=Ot.call(this,t);return i==null&&(i=$t.call(this,e)),i},fixed:G}},symbolSize:{applyVisual:K("symbolSize"),_normalizedToVisual:Vt([0,1])}},n}();function wi(n){var e=n.pieceList;n.hasSpecialVisual=!1,_(e,function(t,i){t.originIndex=i,t.visual!=null&&(n.hasSpecialVisual=!0)})}function xi(n){var e=n.categories,t=n.categoryMap={},i=n.visual;if(J(e,function(o,s){t[o]=s}),!O(i)){var r=[];B(i)?J(i,function(o,s){var l=t[s];r[l??ut]=o}):r[ut]=i,i=be(n,r)}for(var a=e.length-1;a>=0;a--)i[a]==null&&(delete t[e[a]],e.pop())}function _t(n,e){var t=n.visual,i=[];B(t)?J(t,function(a){i.push(a)}):t!=null&&i.push(t);var r={color:1,symbol:1};!e&&i.length===1&&!r.hasOwnProperty(n.type)&&(i[1]=i[0]),be(n,i)}function rt(n){return{applyVisual:function(e,t,i){var r=this.mapValueToVisual(e);i("color",n(t("color"),r))},_normalizedToVisual:Vt([0,1])}}function $t(n){var e=this.option.visual;return e[Math.round($(n,[0,1],[0,e.length-1],!0))]||{}}function K(n){return function(e,t,i){i(n,this.mapValueToVisual(e))}}function Q(n){var e=this.option.visual;return e[this.option.loop&&n!==ut?n%e.length:n]}function G(){return this.option.visual[0]}function Vt(n){return{linear:function(e){return $(e,n,this.option.visual,!0)},category:Q,piecewise:function(e,t){var i=Ot.call(this,t);return i==null&&(i=$(e,n,this.option.visual,!0)),i},fixed:G}}function Ot(n){var e=this.option,t=e.pieceList;if(e.hasSpecialVisual){var i=zt.findPieceIndex(n,t),r=t[i];if(r&&r.visual)return r.visual[this.type]}}function be(n,e){return n.visual=e,n.type==="color"&&(n.parsedVisual=ft(e,function(t){var i=He(t);return i||[0,0,0,1]})),e}var bi={linear:function(n){return $(n,this.option.dataExtent,[0,1],!0)},piecewise:function(n){var e=this.option.pieceList,t=zt.findPieceIndex(n,e,!0);if(t!=null)return $(t,[0,e.length-1],[0,1],!0)},category:function(n){var e=this.option.categories?this.option.categoryMap[n]:n;return e??ut},fixed:xt};function at(n,e,t){return n?e<=t:e<t}const R=zt;function Mi(n,e,t,i,r,a){n=n||0;var o=t[1]-t[0];if(r!=null&&(r=W(r,[0,o])),a!=null&&(a=Math.max(a,r??0)),i==="all"){var s=Math.abs(e[1]-e[0]);s=W(s,[0,o]),r=a=W(s,[r,a]),i=0}e[0]=W(e[0],t),e[1]=W(e[1],t);var l=St(e,i);e[i]+=n;var h=r||0,f=t.slice();l.sign<0?f[0]+=h:f[1]-=h,e[i]=W(e[i],f);var u;return u=St(e,i),r!=null&&(u.sign!==l.sign||u.span<r)&&(e[1-i]=e[i]+l.sign*r),u=St(e,i),a!=null&&u.span>a&&(e[1-i]=e[i]+u.sign*a),e}function St(n,e){var t=n[e]-n[1-e];return{span:Math.abs(t),sign:t>0?-1:t<0?1:e?-1:1}}function W(n,e){return Math.min(e[1]!=null?e[1]:1/0,Math.max(e[0]!=null?e[0]:-1/0,n))}var Ti=256,Ci=function(){function n(){this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={inRange:null,outOfRange:null};var e=Ht.createCanvas();this.canvas=e}return n.prototype.update=function(e,t,i,r,a,o){var s=this._getBrush(),l=this._getGradient(a,"inRange"),h=this._getGradient(a,"outOfRange"),f=this.pointSize+this.blurSize,u=this.canvas,p=u.getContext("2d"),v=e.length;u.width=t,u.height=i;for(var c=0;c<v;++c){var d=e[c],g=d[0],m=d[1],S=d[2],y=r(S);p.globalAlpha=y,p.drawImage(s,g-f,m-f)}if(!u.width||!u.height)return u;for(var M=p.getImageData(0,0,u.width,u.height),b=M.data,w=0,z=b.length,V=this.minOpacity,D=this.maxOpacity,C=D-V;w<z;){var y=b[w+3]/256,x=Math.floor(y*(Ti-1))*4;if(y>0){var T=o(y)?l:h;y>0&&(y=y*C+V),b[w++]=T[x],b[w++]=T[x+1],b[w++]=T[x+2],b[w++]=T[x+3]*y*256}else w+=4}return p.putImageData(M,0,0),u},n.prototype._getBrush=function(){var e=this._brushCanvas||(this._brushCanvas=Ht.createCanvas()),t=this.pointSize+this.blurSize,i=t*2;e.width=i,e.height=i;var r=e.getContext("2d");return r.clearRect(0,0,i,i),r.shadowOffsetX=i,r.shadowBlur=this.blurSize,r.shadowColor="#000",r.beginPath(),r.arc(-t,t,this.pointSize,0,Math.PI*2,!0),r.closePath(),r.fill(),e},n.prototype._getGradient=function(e,t){for(var i=this._gradientPixels,r=i[t]||(i[t]=new Uint8ClampedArray(256*4)),a=[0,0,0,0],o=0,s=0;s<256;s++)e[t](s/255,!0,a),r[o++]=a[0],r[o++]=a[1],r[o++]=a[2],r[o++]=a[3];return r},n}();const Ii=Ci;function Vi(n,e,t){var i=n[1]-n[0];e=ft(e,function(o){return{interval:[(o.interval[0]-n[0])/i,(o.interval[1]-n[0])/i]}});var r=e.length,a=0;return function(o){var s;for(s=a;s<r;s++){var l=e[s].interval;if(l[0]<=o&&o<=l[1]){a=s;break}}if(s===r)for(s=a-1;s>=0;s--){var l=e[s].interval;if(l[0]<=o&&o<=l[1]){a=s;break}}return s>=0&&s<r&&t[s]}}function Oi(n,e){var t=n[1]-n[0];return e=[(e[0]-n[0])/t,(e[1]-n[0])/t],function(i){return i>=e[0]&&i<=e[1]}}function Wt(n){var e=n.dimensions;return e[0]==="lng"&&e[1]==="lat"}var zi=function(n){P(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,i,r){var a;i.eachComponent("visualMap",function(s){s.eachTargetSeries(function(l){l===t&&(a=s)})}),this._progressiveEls=null,this.group.removeAll();var o=t.coordinateSystem;o.type==="cartesian2d"||o.type==="calendar"?this._renderOnCartesianAndCalendar(t,r,0,t.getData().count()):Wt(o)&&this._renderOnGeo(o,t,a,r)},e.prototype.incrementalPrepareRender=function(t,i,r){this.group.removeAll()},e.prototype.incrementalRender=function(t,i,r,a){var o=i.coordinateSystem;o&&(Wt(o)?this.render(i,r,a):(this._progressiveEls=[],this._renderOnCartesianAndCalendar(i,a,t.start,t.end,!0)))},e.prototype.eachRendered=function(t){Pe(this._progressiveEls||this.group,t)},e.prototype._renderOnCartesianAndCalendar=function(t,i,r,a,o){var s=t.coordinateSystem,l=Ae(s,"cartesian2d"),h,f,u,p;if(l){var v=s.getAxis("x"),c=s.getAxis("y");h=v.getBandWidth()+.5,f=c.getBandWidth()+.5,u=v.scale.getExtent(),p=c.scale.getExtent()}for(var d=this.group,g=t.getData(),m=t.getModel(["emphasis","itemStyle"]).getItemStyle(),S=t.getModel(["blur","itemStyle"]).getItemStyle(),y=t.getModel(["select","itemStyle"]).getItemStyle(),M=t.get(["itemStyle","borderRadius"]),b=kt(t),w=t.getModel("emphasis"),z=w.get("focus"),V=w.get("blurScope"),D=w.get("disabled"),C=l?[g.mapDimension("x"),g.mapDimension("y"),g.mapDimension("value")]:[g.mapDimension("time"),g.mapDimension("value")],x=r;x<a;x++){var T=void 0,E=g.getItemVisual(x,"style");if(l){var F=g.get(C[0],x),tt=g.get(C[1],x);if(isNaN(g.get(C[2],x))||isNaN(F)||isNaN(tt)||F<u[0]||F>u[1]||tt<p[0]||tt>p[1])continue;var Dt=s.dataToPoint([F,tt]);T=new j({shape:{x:Dt[0]-h/2,y:Dt[1]-f/2,width:h,height:f},style:E})}else{if(isNaN(g.get(C[1],x)))continue;T=new j({z2:1,shape:s.dataToRect([g.get(C[0],x)]).contentShape,style:E})}if(g.hasItemOption){var Z=g.getItemModel(x),et=Z.getModel("emphasis");m=et.getModel("itemStyle").getItemStyle(),S=Z.getModel(["blur","itemStyle"]).getItemStyle(),y=Z.getModel(["select","itemStyle"]).getItemStyle(),M=Z.get(["itemStyle","borderRadius"]),z=et.get("focus"),V=et.get("blurScope"),D=et.get("disabled"),b=kt(Z)}T.shape.r=M;var pt=t.getRawValue(x),Lt="-";pt&&pt[2]!=null&&(Lt=pt[2]+""),Be(T,b,{labelFetcher:t,labelDataIndex:x,defaultOpacity:E.opacity,defaultText:Lt}),T.ensureState("emphasis").style=m,T.ensureState("blur").style=S,T.ensureState("select").style=y,Ne(T,z,V,D),T.incremental=o,o&&(T.states.emphasis.hoverLayer=!0),d.add(T),g.setItemGraphicEl(x,T),this._progressiveEls&&this._progressiveEls.push(T)}},e.prototype._renderOnGeo=function(t,i,r,a){var o=r.targetVisuals.inRange,s=r.targetVisuals.outOfRange,l=i.getData(),h=this._hmLayer||this._hmLayer||new Ii;h.blurSize=i.get("blurSize"),h.pointSize=i.get("pointSize"),h.minOpacity=i.get("minOpacity"),h.maxOpacity=i.get("maxOpacity");var f=t.getViewRect().clone(),u=t.getRoamTransform();f.applyTransform(u);var p=Math.max(f.x,0),v=Math.max(f.y,0),c=Math.min(f.width+f.x,a.getWidth()),d=Math.min(f.height+f.y,a.getHeight()),g=c-p,m=d-v,S=[l.mapDimension("lng"),l.mapDimension("lat"),l.mapDimension("value")],y=l.mapArray(S,function(z,V,D){var C=t.dataToPoint([z,V]);return C[0]-=p,C[1]-=v,C.push(D),C}),M=r.getExtent(),b=r.type==="visualMap.continuous"?Oi(M,r.option.range):Vi(M,r.getPieceList(),r.option.selected);h.update(y,g,m,o.color.getNormalizer(),{inRange:o.color.getColorMapper(),outOfRange:s.color.getColorMapper()},b);var w=new ve({style:{width:g,height:m,x:p,y:v,image:h.canvas},silent:!0});this.group.add(w)},e.type="heatmap",e}(Ee);const Ri=zi;var Di=function(n){P(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.getInitialData=function(t,i){return Fe(null,this,{generateCoord:"value"})},e.prototype.preventIncremental=function(){var t=Ge.get(this.get("coordinateSystem"));if(t&&t.dimensions)return t.dimensions[0]==="lng"&&t.dimensions[1]==="lat"},e.type="series.heatmap",e.dependencies=["grid","geo","calendar"],e.defaultOption={coordinateSystem:"cartesian2d",z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0,select:{itemStyle:{borderColor:"#212121"}}},e}(Xe);const Li=Di;function Hr(n){n.registerChartView(Ri),n.registerSeriesModel(Li)}var Hi=function(n){P(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="tooltip",e.dependencies=["axisPointer"],e.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},e}(ce);const ki=Hi;function Me(n){var e=n.get("confine");return e!=null?!!e:n.get("renderMode")==="richText"}function Te(n){if(L.domSupported){for(var e=document.documentElement.style,t=0,i=n.length;t<i;t++)if(n[t]in e)return n[t]}}var Ce=Te(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Pi=Te(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function Ie(n,e){if(!n)return e;e=de(e,!0);var t=n.indexOf(e);return n=t===-1?e:"-"+n.slice(0,t)+"-"+e,n.toLowerCase()}function Ai(n,e){var t=n.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(n);return t?e?t[e]:t:null}var Bi=Ie(Pi,"transition"),Rt=Ie(Ce,"transform"),Ni="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(L.transform3dSupported?"will-change:transform;":"");function Ei(n){return n=n==="left"?"right":n==="right"?"left":n==="top"?"bottom":"top",n}function Fi(n,e,t){if(!A(t)||t==="inside")return"";var i=n.get("backgroundColor"),r=n.get("borderWidth");e=st(e);var a=Ei(t),o=Math.max(Math.round(r)*1.5,6),s="",l=Rt+":",h;Ye(["left","right"],a)>-1?(s+="top:50%",l+="translateY(-50%) rotate("+(h=a==="left"?-225:-45)+"deg)"):(s+="left:50%",l+="translateX(-50%) rotate("+(h=a==="top"?225:45)+"deg)");var f=h*Math.PI/180,u=o+r,p=u*Math.abs(Math.cos(f))+u*Math.abs(Math.sin(f)),v=Math.round(((p-Math.SQRT2*r)/2+Math.SQRT2*r-(p-u)/2)*100)/100;s+=";"+a+":-"+v+"px";var c=e+" solid "+r+"px;",d=["position:absolute;width:"+o+"px;height:"+o+"px;z-index:-1;",s+";"+l+";","border-bottom:"+c,"border-right:"+c,"background-color:"+i+";"];return'<div style="'+d.join("")+'"></div>'}function Gi(n,e){var t="cubic-bezier(0.23,1,0.32,1)",i=" "+n/2+"s "+t,r="opacity"+i+",visibility"+i;return e||(i=" "+n+"s "+t,r+=L.transformSupported?","+Rt+i:",left"+i+",top"+i),Bi+":"+r}function Yt(n,e,t){var i=n.toFixed(0)+"px",r=e.toFixed(0)+"px";if(!L.transformSupported)return t?"top:"+r+";left:"+i+";":[["top",r],["left",i]];var a=L.transform3dSupported,o="translate"+(a?"3d":"")+"("+i+","+r+(a?",0":"")+")";return t?"top:0;left:0;"+Rt+":"+o+";":[["top",0],["left",0],[Ce,o]]}function Xi(n){var e=[],t=n.get("fontSize"),i=n.getTextColor();i&&e.push("color:"+i),e.push("font:"+n.getFont()),t&&e.push("line-height:"+Math.round(t*3/2)+"px");var r=n.get("textShadowColor"),a=n.get("textShadowBlur")||0,o=n.get("textShadowOffsetX")||0,s=n.get("textShadowOffsetY")||0;return r&&a&&e.push("text-shadow:"+o+"px "+s+"px "+a+"px "+r),_(["decoration","align"],function(l){var h=n.get(l);h&&e.push("text-"+l+":"+h)}),e.join(";")}function $i(n,e,t){var i=[],r=n.get("transitionDuration"),a=n.get("backgroundColor"),o=n.get("shadowBlur"),s=n.get("shadowColor"),l=n.get("shadowOffsetX"),h=n.get("shadowOffsetY"),f=n.getModel("textStyle"),u=ge(n,"html"),p=l+"px "+h+"px "+o+"px "+s;return i.push("box-shadow:"+p),e&&r&&i.push(Gi(r,t)),a&&i.push("background-color:"+a),_(["width","color","radius"],function(v){var c="border-"+v,d=de(c),g=n.get(d);g!=null&&i.push(c+":"+g+(v==="color"?"":"px"))}),i.push(Xi(f)),u!=null&&i.push("padding:"+ye(u).join("px ")+"px"),i.join(";")+";"}function Ut(n,e,t,i,r){var a=e&&e.painter;if(t){var o=a&&a.getViewportRoot();o&&Ue(n,o,document.body,i,r)}else{n[0]=i,n[1]=r;var s=a&&a.getViewportRootOffset();s&&(n[0]+=s.offsetLeft,n[1]+=s.offsetTop)}n[2]=n[0]/e.getWidth(),n[3]=n[1]/e.getHeight()}var Wi=function(){function n(e,t,i){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,L.wxa)return null;var r=document.createElement("div");r.domBelongToZr=!0,this.el=r;var a=this._zr=t.getZr(),o=this._appendToBody=i&&i.appendToBody;Ut(this._styleCoord,a,o,t.getWidth()/2,t.getHeight()/2),o?document.body.appendChild(r):e.appendChild(r),this._container=e;var s=this;r.onmouseenter=function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0},r.onmousemove=function(l){if(l=l||window.event,!s._enterable){var h=a.handler,f=a.painter.getViewportRoot();$e(f,l,!0),h.dispatch("mousemove",l)}},r.onmouseleave=function(){s._inContent=!1,s._enterable&&s._show&&s.hideLater(s._hideDelay)}}return n.prototype.update=function(e){var t=this._container,i=Ai(t,"position"),r=t.style;r.position!=="absolute"&&i!=="absolute"&&(r.position="relative");var a=e.get("alwaysShowContent");a&&this._moveIfResized(),this._alwaysShowContent=a,this.el.className=e.get("className")||""},n.prototype.show=function(e,t){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var i=this.el,r=i.style,a=this._styleCoord;i.innerHTML?r.cssText=Ni+$i(e,!this._firstShow,this._longHide)+Yt(a[0],a[1],!0)+("border-color:"+st(t)+";")+(e.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):r.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},n.prototype.setContent=function(e,t,i,r,a){var o=this.el;if(e==null){o.innerHTML="";return}var s="";if(A(a)&&i.get("trigger")==="item"&&!Me(i)&&(s=Fi(i,r,a)),A(e))o.innerHTML=e+s;else if(e){o.innerHTML="",O(e)||(e=[e]);for(var l=0;l<e.length;l++)We(e[l])&&e[l].parentNode!==o&&o.appendChild(e[l]);if(s&&o.childNodes.length){var h=document.createElement("div");h.innerHTML=s,o.appendChild(h)}}},n.prototype.setEnterable=function(e){this._enterable=e},n.prototype.getSize=function(){var e=this.el;return[e.offsetWidth,e.offsetHeight]},n.prototype.moveTo=function(e,t){var i=this._styleCoord;if(Ut(i,this._zr,this._appendToBody,e,t),i[0]!=null&&i[1]!=null){var r=this.el.style,a=Yt(i[0],i[1]);_(a,function(o){r[o[0]]=o[1]})}},n.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},n.prototype.hide=function(){var e=this,t=this.el.style;t.visibility="hidden",t.opacity="0",L.transform3dSupported&&(t.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return e._longHide=!0},500)},n.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(I(this.hide,this),e)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){this.el.parentNode.removeChild(this.el)},n}();const Yi=Wi;var Ui=function(){function n(e){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=e.getZr(),Kt(this._styleCoord,this._zr,e.getWidth()/2,e.getHeight()/2)}return n.prototype.update=function(e){var t=e.get("alwaysShowContent");t&&this._moveIfResized(),this._alwaysShowContent=t},n.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},n.prototype.setContent=function(e,t,i,r,a){var o=this;B(e)&&Ze(""),this.el&&this._zr.remove(this.el);var s=i.getModel("textStyle");this.el=new U({style:{rich:t.richTextStyles,text:e,lineHeight:22,borderWidth:1,borderColor:r,textShadowColor:s.get("textShadowColor"),fill:i.get(["textStyle","color"]),padding:ge(i,"richText"),verticalAlign:"top",align:"left"},z:i.get("z")}),_(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(h){o.el.style[h]=i.get(h)}),_(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(h){o.el.style[h]=s.get(h)||0}),this._zr.add(this.el);var l=this;this.el.on("mouseover",function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0}),this.el.on("mouseout",function(){l._enterable&&l._show&&l.hideLater(l._hideDelay),l._inContent=!1})},n.prototype.setEnterable=function(e){this._enterable=e},n.prototype.getSize=function(){var e=this.el,t=this.el.getBoundingRect(),i=Zt(e.style);return[t.width+i.left+i.right,t.height+i.top+i.bottom]},n.prototype.moveTo=function(e,t){var i=this.el;if(i){var r=this._styleCoord;Kt(r,this._zr,e,t),e=r[0],t=r[1];var a=i.style,o=N(a.borderWidth||0),s=Zt(a);i.x=e+o+s.left,i.y=t+o+s.top,i.markRedraw()}},n.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},n.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},n.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(I(this.hide,this),e)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){this._zr.remove(this.el)},n}();function N(n){return Math.max(0,n)}function Zt(n){var e=N(n.shadowBlur||0),t=N(n.shadowOffsetX||0),i=N(n.shadowOffsetY||0);return{left:N(e-t),right:N(e+t),top:N(e-i),bottom:N(e+i)}}function Kt(n,e,t,i){n[0]=t,n[1]=i,n[2]=n[0]/e.getWidth(),n[3]=n[1]/e.getHeight()}const Zi=Ui;var Ki=new j({shape:{x:-1,y:-1,width:2,height:2}}),qi=function(n){P(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.init=function(t,i){if(!(L.node||!i.getDom())){var r=t.getComponent("tooltip"),a=this._renderMode=Ke(r.get("renderMode"));this._tooltipContent=a==="richText"?new Zi(i):new Yi(i.getDom(),i,{appendToBody:r.get("appendToBody",!0)})}},e.prototype.render=function(t,i,r){if(!(L.node||!r.getDom())){this.group.removeAll(),this._tooltipModel=t,this._ecModel=i,this._api=r;var a=this._tooltipContent;a.update(t),a.setEnterable(t.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&t.get("transitionDuration")?qe(this,"_updatePosition",50,"fixRate"):Pt(this,"_updatePosition")}},e.prototype._initGlobalListener=function(){var t=this._tooltipModel,i=t.get("triggerOn");Qe("itemTooltip",this._api,I(function(r,a,o){i!=="none"&&(i.indexOf(r)>=0?this._tryShow(a,o):r==="leave"&&this._hide(o))},this))},e.prototype._keepShow=function(){var t=this._tooltipModel,i=this._ecModel,r=this._api,a=t.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&a!=="none"&&a!=="click"){var o=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!r.isDisposed()&&o.manuallyShowTip(t,i,r,{x:o._lastX,y:o._lastY,dataByCoordSys:o._lastDataByCoordSys})})}},e.prototype.manuallyShowTip=function(t,i,r,a){if(!(a.from===this.uid||L.node||!r.getDom())){var o=qt(a,r);this._ticket="";var s=a.dataByCoordSys,l=tr(a,i,r);if(l){var h=l.el.getBoundingRect().clone();h.applyTransform(l.el.transform),this._tryShow({offsetX:h.x+h.width/2,offsetY:h.y+h.height/2,target:l.el,position:a.position,positionDefault:"bottom"},o)}else if(a.tooltip&&a.x!=null&&a.y!=null){var f=Ki;f.x=a.x,f.y=a.y,f.update(),X(f).tooltipConfig={name:null,option:a.tooltip},this._tryShow({offsetX:a.x,offsetY:a.y,target:f},o)}else if(s)this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,dataByCoordSys:s,tooltipOption:a.tooltipOption},o);else if(a.seriesIndex!=null){if(this._manuallyAxisShowTip(t,i,r,a))return;var u=je(a,i),p=u.point[0],v=u.point[1];p!=null&&v!=null&&this._tryShow({offsetX:p,offsetY:v,target:u.el,position:a.position,positionDefault:"bottom"},o)}else a.x!=null&&a.y!=null&&(r.dispatchAction({type:"updateAxisPointer",x:a.x,y:a.y}),this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,target:r.getZr().findHover(a.x,a.y).target},o))}},e.prototype.manuallyHideTip=function(t,i,r,a){var o=this._tooltipContent;this._tooltipModel&&o.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,a.from!==this.uid&&this._hide(qt(a,r))},e.prototype._manuallyAxisShowTip=function(t,i,r,a){var o=a.seriesIndex,s=a.dataIndex,l=i.getComponent("axisPointer").coordSysAxesInfo;if(!(o==null||s==null||l==null)){var h=i.getSeriesByIndex(o);if(h){var f=h.getData(),u=q([f.getItemModel(s),h,(h.coordinateSystem||{}).model],this._tooltipModel);if(u.get("trigger")==="axis")return r.dispatchAction({type:"updateAxisPointer",seriesIndex:o,dataIndex:s,position:a.position}),!0}}},e.prototype._tryShow=function(t,i){var r=t.target,a=this._tooltipModel;if(a){this._lastX=t.offsetX,this._lastY=t.offsetY;var o=t.dataByCoordSys;if(o&&o.length)this._showAxisTooltip(o,t);else if(r){this._lastDataByCoordSys=null;var s,l;me(r,function(h){if(X(h).dataIndex!=null)return s=h,!0;if(X(h).tooltipConfig!=null)return l=h,!0},!0),s?this._showSeriesItemTooltip(t,s,i):l?this._showComponentItemTooltip(t,l,i):this._hide(i)}else this._lastDataByCoordSys=null,this._hide(i)}},e.prototype._showOrMove=function(t,i){var r=t.get("showDelay");i=I(i,this),clearTimeout(this._showTimout),r>0?this._showTimout=setTimeout(i,r):i()},e.prototype._showAxisTooltip=function(t,i){var r=this._ecModel,a=this._tooltipModel,o=[i.offsetX,i.offsetY],s=q([i.tooltipOption],a),l=this._renderMode,h=[],f=At("section",{blocks:[],noHeader:!0}),u=[],p=new gt;_(t,function(S){_(S.dataByAxis,function(y){var M=r.getComponent(y.axisDim+"Axis",y.axisIndex),b=y.value;if(!(!M||b==null)){var w=Je(b,M.axis,r,y.seriesDataIndices,y.valueLabelOpt),z=At("section",{header:w,noHeader:!ti(w),sortBlocks:!0,blocks:[]});f.blocks.push(z),_(y.seriesDataIndices,function(V){var D=r.getSeriesByIndex(V.seriesIndex),C=V.dataIndexInside,x=D.getDataParams(C);if(!(x.dataIndex<0)){x.axisDim=y.axisDim,x.axisIndex=y.axisIndex,x.axisType=y.axisType,x.axisId=y.axisId,x.axisValue=ei(M.axis,{value:b}),x.axisValueLabel=w,x.marker=p.makeTooltipMarker("item",st(x.color),l);var T=Bt(D.formatTooltip(C,!0,null)),E=T.frag;if(E){var F=q([D],a).get("valueFormatter");z.blocks.push(F?bt({valueFormatter:F},E):E)}T.text&&u.push(T.text),h.push(x)}})}})}),f.blocks.reverse(),u.reverse();var v=i.position,c=s.get("order"),d=Nt(f,p,l,c,r.get("useUTC"),s.get("textStyle"));d&&u.unshift(d);var g=l==="richText"?`

`:"<br/>",m=u.join(g);this._showOrMove(s,function(){this._updateContentNotChangedOnAxis(t,h)?this._updatePosition(s,v,o[0],o[1],this._tooltipContent,h):this._showTooltipContent(s,m,h,Math.random()+"",o[0],o[1],v,null,p)})},e.prototype._showSeriesItemTooltip=function(t,i,r){var a=this._ecModel,o=X(i),s=o.seriesIndex,l=a.getSeriesByIndex(s),h=o.dataModel||l,f=o.dataIndex,u=o.dataType,p=h.getData(u),v=this._renderMode,c=t.positionDefault,d=q([p.getItemModel(f),h,l&&(l.coordinateSystem||{}).model],this._tooltipModel,c?{position:c}:null),g=d.get("trigger");if(!(g!=null&&g!=="item")){var m=h.getDataParams(f,u),S=new gt;m.marker=S.makeTooltipMarker("item",st(m.color),v);var y=Bt(h.formatTooltip(f,!1,u)),M=d.get("order"),b=d.get("valueFormatter"),w=y.frag,z=w?Nt(b?bt({valueFormatter:b},w):w,S,v,M,a.get("useUTC"),d.get("textStyle")):y.text,V="item_"+h.name+"_"+f;this._showOrMove(d,function(){this._showTooltipContent(d,z,m,V,t.offsetX,t.offsetY,t.position,t.target,S)}),r({type:"showTip",dataIndexInside:f,dataIndex:p.getRawIndex(f),seriesIndex:s,from:this.uid})}},e.prototype._showComponentItemTooltip=function(t,i,r){var a=X(i),o=a.tooltipConfig,s=o.option||{};if(A(s)){var l=s;s={content:l,formatter:l}}var h=[s],f=this._ecModel.getComponent(a.componentMainType,a.componentIndex);f&&h.push(f),h.push({formatter:s.content});var u=t.positionDefault,p=q(h,this._tooltipModel,u?{position:u}:null),v=p.get("content"),c=Math.random()+"",d=new gt;this._showOrMove(p,function(){var g=H(p.get("formatterParams")||{});this._showTooltipContent(p,v,g,c,t.offsetX,t.offsetY,t.position,i,d)}),r({type:"showTip",from:this.uid})},e.prototype._showTooltipContent=function(t,i,r,a,o,s,l,h,f){if(this._ticket="",!(!t.get("showContent")||!t.get("show"))){var u=this._tooltipContent;u.setEnterable(t.get("enterable"));var p=t.get("formatter");l=l||t.get("position");var v=i,c=this._getNearestPoint([o,s],r,t.get("trigger"),t.get("borderColor")),d=c.color;if(p)if(A(p)){var g=t.ecModel.get("useUTC"),m=O(r)?r[0]:r,S=m&&m.axisType&&m.axisType.indexOf("time")>=0;v=p,S&&(v=ii(m.axisValue,v,g)),v=ri(v,r,!0)}else if(Mt(p)){var y=I(function(M,b){M===this._ticket&&(u.setContent(b,f,t,d,l),this._updatePosition(t,l,o,s,u,r,h))},this);this._ticket=a,v=p(r,a,y)}else v=p;u.setContent(v,f,t,d,l),u.show(t,d),this._updatePosition(t,l,o,s,u,r,h)}},e.prototype._getNearestPoint=function(t,i,r,a){if(r==="axis"||O(i))return{color:a||(this._renderMode==="html"?"#fff":"none")};if(!O(i))return{color:a||i.color||i.borderColor}},e.prototype._updatePosition=function(t,i,r,a,o,s,l){var h=this._api.getWidth(),f=this._api.getHeight();i=i||t.get("position");var u=o.getSize(),p=t.get("align"),v=t.get("verticalAlign"),c=l&&l.getBoundingRect().clone();if(l&&c.applyTransform(l.transform),Mt(i)&&(i=i([r,a],s,o.el,c,{viewSize:[h,f],contentSize:u.slice()})),O(i))r=Et(i[0],h),a=Et(i[1],f);else if(B(i)){var d=i;d.width=u[0],d.height=u[1];var g=_e(d,{width:h,height:f});r=g.x,a=g.y,p=null,v=null}else if(A(i)&&l){var m=Ji(i,c,u,t.get("borderWidth"));r=m[0],a=m[1]}else{var m=Qi(r,a,o,h,f,p?null:20,v?null:20);r=m[0],a=m[1]}if(p&&(r-=Qt(p)?u[0]/2:p==="right"?u[0]:0),v&&(a-=Qt(v)?u[1]/2:v==="bottom"?u[1]:0),Me(t)){var m=ji(r,a,o,h,f);r=m[0],a=m[1]}o.moveTo(r,a)},e.prototype._updateContentNotChangedOnAxis=function(t,i){var r=this._lastDataByCoordSys,a=this._cbParamsList,o=!!r&&r.length===t.length;return o&&_(r,function(s,l){var h=s.dataByAxis||[],f=t[l]||{},u=f.dataByAxis||[];o=o&&h.length===u.length,o&&_(h,function(p,v){var c=u[v]||{},d=p.seriesDataIndices||[],g=c.seriesDataIndices||[];o=o&&p.value===c.value&&p.axisType===c.axisType&&p.axisId===c.axisId&&d.length===g.length,o&&_(d,function(m,S){var y=g[S];o=o&&m.seriesIndex===y.seriesIndex&&m.dataIndex===y.dataIndex}),a&&_(p.seriesDataIndices,function(m){var S=m.seriesIndex,y=i[S],M=a[S];y&&M&&M.data!==y.data&&(o=!1)})})}),this._lastDataByCoordSys=t,this._cbParamsList=i,!!o},e.prototype._hide=function(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid})},e.prototype.dispose=function(t,i){L.node||!i.getDom()||(Pt(this,"_updatePosition"),this._tooltipContent.dispose(),ai("itemTooltip",i))},e.type="tooltip",e}(Se);function q(n,e,t){var i=e.ecModel,r;t?(r=new it(t,i,i),r=new it(e.option,r,i)):r=e;for(var a=n.length-1;a>=0;a--){var o=n[a];o&&(o instanceof it&&(o=o.get("tooltip",!0)),A(o)&&(o={formatter:o}),o&&(r=new it(o,r,i)))}return r}function qt(n,e){return n.dispatchAction||I(e.dispatchAction,e)}function Qi(n,e,t,i,r,a,o){var s=t.getSize(),l=s[0],h=s[1];return a!=null&&(n+l+a+2>i?n-=l+a:n+=a),o!=null&&(e+h+o>r?e-=h+o:e+=o),[n,e]}function ji(n,e,t,i,r){var a=t.getSize(),o=a[0],s=a[1];return n=Math.min(n+o,i)-o,e=Math.min(e+s,r)-s,n=Math.max(n,0),e=Math.max(e,0),[n,e]}function Ji(n,e,t,i){var r=t[0],a=t[1],o=Math.ceil(Math.SQRT2*i)+8,s=0,l=0,h=e.width,f=e.height;switch(n){case"inside":s=e.x+h/2-r/2,l=e.y+f/2-a/2;break;case"top":s=e.x+h/2-r/2,l=e.y-a-o;break;case"bottom":s=e.x+h/2-r/2,l=e.y+f+o;break;case"left":s=e.x-r-o,l=e.y+f/2-a/2;break;case"right":s=e.x+h+o,l=e.y+f/2-a/2}return[s,l]}function Qt(n){return n==="center"||n==="middle"}function tr(n,e,t){var i=ni(n).queryOptionMap,r=i.keys()[0];if(!(!r||r==="series")){var a=oi(e,r,i.get(r),{useDefault:!1,enableAll:!1,enableNone:!1}),o=a.models[0];if(o){var s=t.getViewOfComponentModel(o),l;if(s.group.traverse(function(h){var f=X(h).tooltipConfig;if(f&&f.name===n.name)return l=h,!0}),l)return{componentMainType:r,componentIndex:o.componentIndex,el:l}}}}const er=qi;function kr(n){Tt(si),n.registerComponentModel(ki),n.registerComponentView(er),n.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},xt),n.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},xt)}var jt=_;function Jt(n){if(n){for(var e in n)if(n.hasOwnProperty(e))return!0}}function te(n,e,t){var i={};return jt(e,function(a){var o=i[a]=r();jt(n[a],function(s,l){if(R.isValidType(l)){var h={type:l,visual:s};t&&t(h,a),o[l]=new R(h),l==="opacity"&&(h=H(h),h.type="colorAlpha",o.__hidden.__alphaForOpacity=new R(h))}})}),i;function r(){var a=function(){};a.prototype.__hidden=a.prototype;var o=new a;return o}}function ir(n,e,t){var i;_(t,function(r){e.hasOwnProperty(r)&&Jt(e[r])&&(i=!0)}),i&&_(t,function(r){e.hasOwnProperty(r)&&Jt(e[r])?n[r]=H(e[r]):delete n[r]})}function rr(n,e,t,i){var r={};return _(n,function(a){var o=R.prepareVisualTypes(e[a]);r[a]=o}),{progress:function(o,s){var l;i!=null&&(l=s.getDimensionIndex(i));function h(b){return li(s,u,b)}function f(b,w){ui(s,u,b,w)}for(var u,p=s.getStore();(u=o.next())!=null;){var v=s.getRawDataItem(u);if(!(v&&v.visualMap===!1))for(var c=i!=null?p.get(l,u):u,d=t(c),g=e[d],m=r[d],S=0,y=m.length;S<y;S++){var M=m[S];g[M]&&g[M].applyVisual(c,h,f)}}}}}var ar={get:function(n,e,t){var i=H((nr[n]||{})[e]);return t&&O(i)?i[i.length-1]:i}},nr={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}};const Ve=ar;var ee=R.mapVisual,or=R.eachVisual,sr=O,ie=_,lr=we,ur=$,hr=function(n){P(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.stateList=["inRange","outOfRange"],t.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],t.layoutMode={type:"box",ignoreSize:!0},t.dataBound=[-1/0,1/0],t.targetVisuals={},t.controllerVisuals={},t}return e.prototype.init=function(t,i,r){this.mergeDefaultAndTheme(t,r)},e.prototype.optionUpdated=function(t,i){var r=this.option;!i&&ir(r,t,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},e.prototype.resetVisual=function(t){var i=this.stateList;t=I(t,this),this.controllerVisuals=te(this.option.controller,i,t),this.targetVisuals=te(this.option.target,i,t)},e.prototype.getItemSymbol=function(){return null},e.prototype.getTargetSeriesIndices=function(){var t=this.option.seriesIndex,i=[];return t==null||t==="all"?this.ecModel.eachSeries(function(r,a){i.push(a)}):i=hi(t),i},e.prototype.eachTargetSeries=function(t,i){_(this.getTargetSeriesIndices(),function(r){var a=this.ecModel.getSeriesByIndex(r);a&&t.call(i,a)},this)},e.prototype.isTargetSeries=function(t){var i=!1;return this.eachTargetSeries(function(r){r===t&&(i=!0)}),i},e.prototype.formatValueText=function(t,i,r){var a=this.option,o=a.precision,s=this.dataBound,l=a.formatter,h;r=r||["<",">"],O(t)&&(t=t.slice(),h=!0);var f=i?t:h?[u(t[0]),u(t[1])]:u(t);if(A(l))return l.replace("{value}",h?f[0]:f).replace("{value2}",h?f[1]:f);if(Mt(l))return h?l(t[0],t[1]):l(t);if(h)return t[0]===s[0]?r[0]+" "+f[1]:t[1]===s[1]?r[1]+" "+f[0]:f[0]+" - "+f[1];return f;function u(p){return p===s[0]?"min":p===s[1]?"max":(+p).toFixed(Math.min(o,20))}},e.prototype.resetExtent=function(){var t=this.option,i=lr([t.min,t.max]);this._dataExtent=i},e.prototype.getDataDimensionIndex=function(t){var i=this.option.dimension;if(i!=null)return t.getDimensionIndex(i);for(var r=t.dimensions,a=r.length-1;a>=0;a--){var o=r[a],s=t.getDimensionInfo(o);if(!s.isCalculationCoord)return s.storeDimIndex}},e.prototype.getExtent=function(){return this._dataExtent.slice()},e.prototype.completeVisualOption=function(){var t=this.ecModel,i=this.option,r={inRange:i.inRange,outOfRange:i.outOfRange},a=i.target||(i.target={}),o=i.controller||(i.controller={});Ft(a,r),Ft(o,r);var s=this.isCategory();l.call(this,a),l.call(this,o),h.call(this,a,"inRange","outOfRange"),f.call(this,o);function l(u){sr(i.color)&&!u.inRange&&(u.inRange={color:i.color.slice().reverse()}),u.inRange=u.inRange||{color:t.get("gradientColor")}}function h(u,p,v){var c=u[p],d=u[v];c&&!d&&(d=u[v]={},ie(c,function(g,m){if(R.isValidType(m)){var S=Ve.get(m,"inactive",s);S!=null&&(d[m]=S,m==="color"&&!d.hasOwnProperty("opacity")&&!d.hasOwnProperty("colorAlpha")&&(d.opacity=[0,0]))}}))}function f(u){var p=(u.inRange||{}).symbol||(u.outOfRange||{}).symbol,v=(u.inRange||{}).symbolSize||(u.outOfRange||{}).symbolSize,c=this.get("inactiveColor"),d=this.getItemSymbol(),g=d||"roundRect";ie(this.stateList,function(m){var S=this.itemSize,y=u[m];y||(y=u[m]={color:s?c:[c]}),y.symbol==null&&(y.symbol=p&&H(p)||(s?g:[g])),y.symbolSize==null&&(y.symbolSize=v&&H(v)||(s?S[0]:[S[0],S[0]])),y.symbol=ee(y.symbol,function(w){return w==="none"?g:w});var M=y.symbolSize;if(M!=null){var b=-1/0;or(M,function(w){w>b&&(b=w)}),y.symbolSize=ee(M,function(w){return ur(w,[0,b],[0,S[0]],!0)})}},this)}},e.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},e.prototype.isCategory=function(){return!!this.option.categories},e.prototype.setSelected=function(t){},e.prototype.getSelected=function(){return null},e.prototype.getValueState=function(t){return null},e.prototype.getVisualMeta=function(t){return null},e.type="visualMap",e.dependencies=["series"],e.defaultOption={show:!0,z:4,seriesIndex:"all",min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,textStyle:{color:"#333"}},e}(ce);const ht=hr;var re=[20,140],fr=function(n){P(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.optionUpdated=function(t,i){n.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual(function(r){r.mappingMethod="linear",r.dataExtent=this.getExtent()}),this._resetRange()},e.prototype.resetItemSize=function(){n.prototype.resetItemSize.apply(this,arguments);var t=this.itemSize;(t[0]==null||isNaN(t[0]))&&(t[0]=re[0]),(t[1]==null||isNaN(t[1]))&&(t[1]=re[1])},e.prototype._resetRange=function(){var t=this.getExtent(),i=this.option.range;!i||i.auto?(t.auto=1,this.option.range=t):O(i)&&(i[0]>i[1]&&i.reverse(),i[0]=Math.max(i[0],t[0]),i[1]=Math.min(i[1],t[1]))},e.prototype.completeVisualOption=function(){n.prototype.completeVisualOption.apply(this,arguments),_(this.stateList,function(t){var i=this.option.controller[t].symbolSize;i&&i[0]!==i[1]&&(i[0]=i[1]/3)},this)},e.prototype.setSelected=function(t){this.option.range=t.slice(),this._resetRange()},e.prototype.getSelected=function(){var t=this.getExtent(),i=we((this.get("range")||[]).slice());return i[0]>t[1]&&(i[0]=t[1]),i[1]>t[1]&&(i[1]=t[1]),i[0]<t[0]&&(i[0]=t[0]),i[1]<t[0]&&(i[1]=t[0]),i},e.prototype.getValueState=function(t){var i=this.option.range,r=this.getExtent();return(i[0]<=r[0]||i[0]<=t)&&(i[1]>=r[1]||t<=i[1])?"inRange":"outOfRange"},e.prototype.findTargetDataIndices=function(t){var i=[];return this.eachTargetSeries(function(r){var a=[],o=r.getData();o.each(this.getDataDimensionIndex(o),function(s,l){t[0]<=s&&s<=t[1]&&a.push(l)},this),i.push({seriesId:r.id,dataIndex:a})},this),i},e.prototype.getVisualMeta=function(t){var i=ae(this,"outOfRange",this.getExtent()),r=ae(this,"inRange",this.option.range.slice()),a=[];function o(v,c){a.push({value:v,color:t(v,c)})}for(var s=0,l=0,h=r.length,f=i.length;l<f&&(!r.length||i[l]<=r[0]);l++)i[l]<r[s]&&o(i[l],"outOfRange");for(var u=1;s<h;s++,u=0)u&&a.length&&o(r[s],"outOfRange"),o(r[s],"inRange");for(var u=1;l<f;l++)(!r.length||r[r.length-1]<i[l])&&(u&&(a.length&&o(a[a.length-1].value,"outOfRange"),u=0),o(i[l],"outOfRange"));var p=a.length;return{stops:a,outerColors:[p?a[0].color:"transparent",p?a[p-1].color:"transparent"]}},e.type="visualMap.continuous",e.defaultOption=xe(ht.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:"#fff",borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}}),e}(ht);function ae(n,e,t){if(t[0]===t[1])return t.slice();for(var i=200,r=(t[1]-t[0])/i,a=t[0],o=[],s=0;s<=i&&a<t[1];s++)o.push(a),a+=r;return o.push(t[1]),o}const pr=fr;var vr=function(n){P(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.autoPositionValues={left:1,right:1,top:1,bottom:1},t}return e.prototype.init=function(t,i){this.ecModel=t,this.api=i},e.prototype.render=function(t,i,r,a){if(this.visualMapModel=t,t.get("show")===!1){this.group.removeAll();return}this.doRender(t,i,r,a)},e.prototype.renderBackground=function(t){var i=this.visualMapModel,r=ye(i.get("padding")||0),a=t.getBoundingRect();t.add(new j({z2:-1,silent:!0,shape:{x:a.x-r[3],y:a.y-r[0],width:a.width+r[3]+r[1],height:a.height+r[0]+r[2]},style:{fill:i.get("backgroundColor"),stroke:i.get("borderColor"),lineWidth:i.get("borderWidth")}}))},e.prototype.getControllerVisual=function(t,i,r){r=r||{};var a=r.forceState,o=this.visualMapModel,s={};if(i==="color"){var l=o.get("contentColor");s.color=l}function h(v){return s[v]}function f(v,c){s[v]=c}var u=o.controllerVisuals[a||o.getValueState(t)],p=R.prepareVisualTypes(u);return _(p,function(v){var c=u[v];r.convertOpacityToAlpha&&v==="opacity"&&(v="colorAlpha",c=u.__alphaForOpacity),R.dependsOn(v,i)&&c&&c.applyVisual(t,h,f)}),s[i]},e.prototype.positionGroup=function(t){var i=this.visualMapModel,r=this.api;fi(t,i.getBoxLayoutParams(),{width:r.getWidth(),height:r.getHeight()})},e.prototype.doRender=function(t,i,r,a){},e.type="visualMap",e}(Se);const Oe=vr;var ne=[["left","right","width"],["top","bottom","height"]];function ze(n,e,t){var i=n.option,r=i.align;if(r!=null&&r!=="auto")return r;for(var a={width:e.getWidth(),height:e.getHeight()},o=i.orient==="horizontal"?1:0,s=ne[o],l=[0,null,10],h={},f=0;f<3;f++)h[ne[1-o][f]]=l[f],h[s[f]]=f===2?t[0]:i[s[f]];var u=[["x","width",3],["y","height",0]][o],p=_e(h,a,i.padding);return s[(p.margin[u[2]]||0)+p[u[0]]+p[u[1]]*.5<a[u[1]]*.5?0:1]}function ot(n,e){return _(n||[],function(t){t.dataIndex!=null&&(t.dataIndexInside=t.dataIndex,t.dataIndex=null),t.highlightKey="visualMap"+(e?e.componentIndex:"")}),n}var k=$,cr=_,oe=Math.min,wt=Math.max,dr=12,gr=6,yr=function(n){P(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t._shapes={},t._dataInterval=[],t._handleEnds=[],t._hoverLinkDataIndices=[],t}return e.prototype.doRender=function(t,i,r,a){this._api=r,(!a||a.type!=="selectDataRange"||a.from!==this.uid)&&this._buildView()},e.prototype._buildView=function(){this.group.removeAll();var t=this.visualMapModel,i=this.group;this._orient=t.get("orient"),this._useHandle=t.get("calculable"),this._resetInterval(),this._renderBar(i);var r=t.get("text");this._renderEndsText(i,r,0),this._renderEndsText(i,r,1),this._updateView(!0),this.renderBackground(i),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(i)},e.prototype._renderEndsText=function(t,i,r){if(i){var a=i[1-r];a=a!=null?a+"":"";var o=this.visualMapModel,s=o.get("textGap"),l=o.itemSize,h=this._shapes.mainGroup,f=this._applyTransform([l[0]/2,r===0?-s:l[1]+s],h),u=this._applyTransform(r===0?"bottom":"top",h),p=this._orient,v=this.visualMapModel.textStyleModel;this.group.add(new U({style:nt(v,{x:f[0],y:f[1],verticalAlign:p==="horizontal"?"middle":u,align:p==="horizontal"?u:"center",text:a})}))}},e.prototype._renderBar=function(t){var i=this.visualMapModel,r=this._shapes,a=i.itemSize,o=this._orient,s=this._useHandle,l=ze(i,this.api,a),h=r.mainGroup=this._createBarGroup(l),f=new lt;h.add(f),f.add(r.outOfRange=se()),f.add(r.inRange=se(null,s?ue(this._orient):null,I(this._dragHandle,this,"all",!1),I(this._dragHandle,this,"all",!0))),f.setClipPath(new j({shape:{x:0,y:0,width:a[0],height:a[1],r:3}}));var u=i.textStyleModel.getTextRect("国"),p=wt(u.width,u.height);s&&(r.handleThumbs=[],r.handleLabels=[],r.handleLabelPoints=[],this._createHandle(i,h,0,a,p,o),this._createHandle(i,h,1,a,p,o)),this._createIndicator(i,h,a,p,o),t.add(h)},e.prototype._createHandle=function(t,i,r,a,o,s){var l=I(this._dragHandle,this,r,!1),h=I(this._dragHandle,this,r,!0),f=Gt(t.get("handleSize"),a[0]),u=Ct(t.get("handleIcon"),-f/2,-f/2,f,f,null,!0),p=ue(this._orient);u.attr({cursor:p,draggable:!0,drift:l,ondragend:h,onmousemove:function(m){It(m.event)}}),u.x=a[0]/2,u.useStyle(t.getModel("handleStyle").getItemStyle()),u.setStyle({strokeNoScale:!0,strokeFirst:!0}),u.style.lineWidth*=2,u.ensureState("emphasis").style=t.getModel(["emphasis","handleStyle"]).getItemStyle(),pi(u,!0),i.add(u);var v=this.visualMapModel.textStyleModel,c=new U({cursor:p,draggable:!0,drift:l,onmousemove:function(m){It(m.event)},ondragend:h,style:nt(v,{x:0,y:0,text:""})});c.ensureState("blur").style={opacity:.1},c.stateTransition={duration:200},this.group.add(c);var d=[f,0],g=this._shapes;g.handleThumbs[r]=u,g.handleLabelPoints[r]=d,g.handleLabels[r]=c},e.prototype._createIndicator=function(t,i,r,a,o){var s=Gt(t.get("indicatorSize"),r[0]),l=Ct(t.get("indicatorIcon"),-s/2,-s/2,s,s,null,!0);l.attr({cursor:"move",invisible:!0,silent:!0,x:r[0]/2});var h=t.getModel("indicatorStyle").getItemStyle();if(l instanceof ve){var f=l.style;l.useStyle(bt({image:f.image,x:f.x,y:f.y,width:f.width,height:f.height},h))}else l.useStyle(h);i.add(l);var u=this.visualMapModel.textStyleModel,p=new U({silent:!0,invisible:!0,style:nt(u,{x:0,y:0,text:""})});this.group.add(p);var v=[(o==="horizontal"?a/2:gr)+r[0]/2,0],c=this._shapes;c.indicator=l,c.indicatorLabel=p,c.indicatorLabelPoint=v,this._firstShowIndicator=!0},e.prototype._dragHandle=function(t,i,r,a){if(this._useHandle){if(this._dragging=!i,!i){var o=this._applyTransform([r,a],this._shapes.mainGroup,!0);this._updateInterval(t,o[1]),this._hideIndicator(),this._updateView()}i===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),i?!this._hovering&&this._clearHoverLinkToSeries():le(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[t],!1)}},e.prototype._resetInterval=function(){var t=this.visualMapModel,i=this._dataInterval=t.getSelected(),r=t.getExtent(),a=[0,t.itemSize[1]];this._handleEnds=[k(i[0],r,a,!0),k(i[1],r,a,!0)]},e.prototype._updateInterval=function(t,i){i=i||0;var r=this.visualMapModel,a=this._handleEnds,o=[0,r.itemSize[1]];Mi(i,a,o,t,0);var s=r.getExtent();this._dataInterval=[k(a[0],o,s,!0),k(a[1],o,s,!0)]},e.prototype._updateView=function(t){var i=this.visualMapModel,r=i.getExtent(),a=this._shapes,o=[0,i.itemSize[1]],s=t?o:this._handleEnds,l=this._createBarVisual(this._dataInterval,r,s,"inRange"),h=this._createBarVisual(r,r,o,"outOfRange");a.inRange.setStyle({fill:l.barColor}).setShape("points",l.barPoints),a.outOfRange.setStyle({fill:h.barColor}).setShape("points",h.barPoints),this._updateHandle(s,l)},e.prototype._createBarVisual=function(t,i,r,a){var o={forceState:a,convertOpacityToAlpha:!0},s=this._makeColorGradient(t,o),l=[this.getControllerVisual(t[0],"symbolSize",o),this.getControllerVisual(t[1],"symbolSize",o)],h=this._createBarPoints(r,l);return{barColor:new vi(0,0,0,1,s),barPoints:h,handlesColor:[s[0].color,s[s.length-1].color]}},e.prototype._makeColorGradient=function(t,i){var r=100,a=[],o=(t[1]-t[0])/r;a.push({color:this.getControllerVisual(t[0],"color",i),offset:0});for(var s=1;s<r;s++){var l=t[0]+o*s;if(l>t[1])break;a.push({color:this.getControllerVisual(l,"color",i),offset:s/r})}return a.push({color:this.getControllerVisual(t[1],"color",i),offset:1}),a},e.prototype._createBarPoints=function(t,i){var r=this.visualMapModel.itemSize;return[[r[0]-i[0],t[0]],[r[0],t[0]],[r[0],t[1]],[r[0]-i[1],t[1]]]},e.prototype._createBarGroup=function(t){var i=this._orient,r=this.visualMapModel.get("inverse");return new lt(i==="horizontal"&&!r?{scaleX:t==="bottom"?1:-1,rotation:Math.PI/2}:i==="horizontal"&&r?{scaleX:t==="bottom"?-1:1,rotation:-Math.PI/2}:i==="vertical"&&!r?{scaleX:t==="left"?1:-1,scaleY:-1}:{scaleX:t==="left"?1:-1})},e.prototype._updateHandle=function(t,i){if(this._useHandle){var r=this._shapes,a=this.visualMapModel,o=r.handleThumbs,s=r.handleLabels,l=a.itemSize,h=a.getExtent();cr([0,1],function(f){var u=o[f];u.setStyle("fill",i.handlesColor[f]),u.y=t[f];var p=k(t[f],[0,l[1]],h,!0),v=this.getControllerVisual(p,"symbolSize");u.scaleX=u.scaleY=v/l[0],u.x=l[0]-v/2;var c=yt(r.handleLabelPoints[f],mt(u,this.group));s[f].setStyle({x:c[0],y:c[1],text:a.formatValueText(this._dataInterval[f]),verticalAlign:"middle",align:this._orient==="vertical"?this._applyTransform("left",r.mainGroup):"center"})},this)}},e.prototype._showIndicator=function(t,i,r,a){var o=this.visualMapModel,s=o.getExtent(),l=o.itemSize,h=[0,l[1]],f=this._shapes,u=f.indicator;if(u){u.attr("invisible",!1);var p={convertOpacityToAlpha:!0},v=this.getControllerVisual(t,"color",p),c=this.getControllerVisual(t,"symbolSize"),d=k(t,s,h,!0),g=l[0]-c/2,m={x:u.x,y:u.y};u.y=d,u.x=g;var S=yt(f.indicatorLabelPoint,mt(u,this.group)),y=f.indicatorLabel;y.attr("invisible",!1);var M=this._applyTransform("left",f.mainGroup),b=this._orient,w=b==="horizontal";y.setStyle({text:(r||"")+o.formatValueText(i),verticalAlign:w?M:"middle",align:w?"center":M});var z={x:g,y:d,style:{fill:v}},V={style:{x:S[0],y:S[1]}};if(o.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var D={duration:100,easing:"cubicInOut",additive:!0};u.x=m.x,u.y=m.y,u.animateTo(z,D),y.animateTo(V,D)}else u.attr(z),y.attr(V);this._firstShowIndicator=!1;var C=this._shapes.handleLabels;if(C)for(var x=0;x<C.length;x++)this._api.enterBlur(C[x])}},e.prototype._enableHoverLinkToSeries=function(){var t=this;this._shapes.mainGroup.on("mousemove",function(i){if(t._hovering=!0,!t._dragging){var r=t.visualMapModel.itemSize,a=t._applyTransform([i.offsetX,i.offsetY],t._shapes.mainGroup,!0,!0);a[1]=oe(wt(0,a[1]),r[1]),t._doHoverLinkToSeries(a[1],0<=a[0]&&a[0]<=r[0])}}).on("mouseout",function(){t._hovering=!1,!t._dragging&&t._clearHoverLinkToSeries()})},e.prototype._enableHoverLinkFromSeries=function(){var t=this.api.getZr();this.visualMapModel.option.hoverLink?(t.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),t.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},e.prototype._doHoverLinkToSeries=function(t,i){var r=this.visualMapModel,a=r.itemSize;if(r.option.hoverLink){var o=[0,a[1]],s=r.getExtent();t=oe(wt(o[0],t),o[1]);var l=mr(r,s,o),h=[t-l,t+l],f=k(t,o,s,!0),u=[k(h[0],o,s,!0),k(h[1],o,s,!0)];h[0]<o[0]&&(u[0]=-1/0),h[1]>o[1]&&(u[1]=1/0),i&&(u[0]===-1/0?this._showIndicator(f,u[1],"< ",l):u[1]===1/0?this._showIndicator(f,u[0],"> ",l):this._showIndicator(f,f,"≈ ",l));var p=this._hoverLinkDataIndices,v=[];(i||le(r))&&(v=this._hoverLinkDataIndices=r.findTargetDataIndices(u));var c=ci(p,v);this._dispatchHighDown("downplay",ot(c[0],r)),this._dispatchHighDown("highlight",ot(c[1],r))}},e.prototype._hoverLinkFromSeriesMouseOver=function(t){var i;if(me(t.target,function(l){var h=X(l);if(h.dataIndex!=null)return i=h,!0},!0),!!i){var r=this.ecModel.getSeriesByIndex(i.seriesIndex),a=this.visualMapModel;if(a.isTargetSeries(r)){var o=r.getData(i.dataType),s=o.getStore().get(a.getDataDimensionIndex(o),i.dataIndex);isNaN(s)||this._showIndicator(s,s)}}},e.prototype._hideIndicator=function(){var t=this._shapes;t.indicator&&t.indicator.attr("invisible",!0),t.indicatorLabel&&t.indicatorLabel.attr("invisible",!0);var i=this._shapes.handleLabels;if(i)for(var r=0;r<i.length;r++)this._api.leaveBlur(i[r])},e.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var t=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",ot(t,this.visualMapModel)),t.length=0},e.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var t=this.api.getZr();t.off("mouseover",this._hoverLinkFromSeriesMouseOver),t.off("mouseout",this._hideIndicator)},e.prototype._applyTransform=function(t,i,r,a){var o=mt(i,a?null:this.group);return O(t)?yt(t,o,r):di(t,o,r)},e.prototype._dispatchHighDown=function(t,i){i&&i.length&&this.api.dispatchAction({type:t,batch:i})},e.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},e.prototype.remove=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},e.type="visualMap.continuous",e}(Oe);function se(n,e,t,i){return new gi({shape:{points:n},draggable:!!t,cursor:e,drift:t,onmousemove:function(r){It(r.event)},ondragend:i})}function mr(n,e,t){var i=dr/2,r=n.get("hoverLinkDataSize");return r&&(i=k(r,e,t,!0)/2),i}function le(n){var e=n.get("hoverLinkOnHandle");return!!(e??n.get("realtime"))}function ue(n){return n==="vertical"?"ns-resize":"ew-resize"}const _r=yr;var Sr={type:"selectDataRange",event:"dataRangeSelected",update:"update"},wr=function(n,e){e.eachComponent({mainType:"visualMap",query:n},function(t){t.setSelected(n.selected)})},xr=[{createOnAllSeries:!0,reset:function(n,e){var t=[];return e.eachComponent("visualMap",function(i){var r=n.pipelineContext;!i.isTargetSeries(n)||r&&r.large||t.push(rr(i.stateList,i.targetVisuals,I(i.getValueState,i),i.getDataDimensionIndex(n.getData())))}),t}},{createOnAllSeries:!0,reset:function(n,e){var t=n.getData(),i=[];e.eachComponent("visualMap",function(r){if(r.isTargetSeries(n)){var a=r.getVisualMeta(I(br,null,n,r))||{stops:[],outerColors:[]},o=r.getDataDimensionIndex(t);o>=0&&(a.dimension=o,i.push(a))}}),n.getData().setVisual("visualMeta",i)}}];function br(n,e,t,i){for(var r=e.targetVisuals[i],a=R.prepareVisualTypes(r),o={color:yi(n.getData(),"color")},s=0,l=a.length;s<l;s++){var h=a[s],f=r[h==="opacity"?"__alphaForOpacity":h];f&&f.applyVisual(t,u,p)}return o.color;function u(v){return o[v]}function p(v,c){o[v]=c}}var he=_;function Mr(n){var e=n&&n.visualMap;O(e)||(e=e?[e]:[]),he(e,function(t){if(t){Y(t,"splitList")&&!Y(t,"pieces")&&(t.pieces=t.splitList,delete t.splitList);var i=t.pieces;i&&O(i)&&he(i,function(r){B(r)&&(Y(r,"start")&&!Y(r,"min")&&(r.min=r.start),Y(r,"end")&&!Y(r,"max")&&(r.max=r.end))})}})}function Y(n,e){return n&&n.hasOwnProperty&&n.hasOwnProperty(e)}var fe=!1;function Re(n){fe||(fe=!0,n.registerSubTypeDefaulter("visualMap",function(e){return!e.categories&&(!(e.pieces?e.pieces.length>0:e.splitNumber>0)||e.calculable)?"continuous":"piecewise"}),n.registerAction(Sr,wr),_(xr,function(e){n.registerVisual(n.PRIORITY.VISUAL.COMPONENT,e)}),n.registerPreprocessor(Mr))}function Tr(n){n.registerComponentModel(pr),n.registerComponentView(_r),Re(n)}var Cr=function(n){P(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t._pieceList=[],t}return e.prototype.optionUpdated=function(t,i){n.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var r=this._mode=this._determineMode();this._pieceList=[],Ir[this._mode].call(this,this._pieceList),this._resetSelected(t,i);var a=this.option.categories;this.resetVisual(function(o,s){r==="categories"?(o.mappingMethod="category",o.categories=H(a)):(o.dataExtent=this.getExtent(),o.mappingMethod="piecewise",o.pieceList=ft(this._pieceList,function(l){return l=H(l),s!=="inRange"&&(l.visual=null),l}))})},e.prototype.completeVisualOption=function(){var t=this.option,i={},r=R.listVisualTypes(),a=this.isCategory();_(t.pieces,function(s){_(r,function(l){s.hasOwnProperty(l)&&(i[l]=1)})}),_(i,function(s,l){var h=!1;_(this.stateList,function(f){h=h||o(t,f,l)||o(t.target,f,l)},this),!h&&_(this.stateList,function(f){(t[f]||(t[f]={}))[l]=Ve.get(l,f==="inRange"?"active":"inactive",a)})},this);function o(s,l,h){return s&&s[l]&&s[l].hasOwnProperty(h)}n.prototype.completeVisualOption.apply(this,arguments)},e.prototype._resetSelected=function(t,i){var r=this.option,a=this._pieceList,o=(i?r:t).selected||{};if(r.selected=o,_(a,function(l,h){var f=this.getSelectedMapKey(l);o.hasOwnProperty(f)||(o[f]=!0)},this),r.selectedMode==="single"){var s=!1;_(a,function(l,h){var f=this.getSelectedMapKey(l);o[f]&&(s?o[f]=!1:s=!0)},this)}},e.prototype.getItemSymbol=function(){return this.get("itemSymbol")},e.prototype.getSelectedMapKey=function(t){return this._mode==="categories"?t.value+"":t.index+""},e.prototype.getPieceList=function(){return this._pieceList},e.prototype._determineMode=function(){var t=this.option;return t.pieces&&t.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},e.prototype.setSelected=function(t){this.option.selected=H(t)},e.prototype.getValueState=function(t){var i=R.findPieceIndex(t,this._pieceList);return i!=null&&this.option.selected[this.getSelectedMapKey(this._pieceList[i])]?"inRange":"outOfRange"},e.prototype.findTargetDataIndices=function(t){var i=[],r=this._pieceList;return this.eachTargetSeries(function(a){var o=[],s=a.getData();s.each(this.getDataDimensionIndex(s),function(l,h){var f=R.findPieceIndex(l,r);f===t&&o.push(h)},this),i.push({seriesId:a.id,dataIndex:o})},this),i},e.prototype.getRepresentValue=function(t){var i;if(this.isCategory())i=t.value;else if(t.value!=null)i=t.value;else{var r=t.interval||[];i=r[0]===-1/0&&r[1]===1/0?0:(r[0]+r[1])/2}return i},e.prototype.getVisualMeta=function(t){if(this.isCategory())return;var i=[],r=["",""],a=this;function o(f,u){var p=a.getRepresentValue({interval:f});u||(u=a.getValueState(p));var v=t(p,u);f[0]===-1/0?r[0]=v:f[1]===1/0?r[1]=v:i.push({value:f[0],color:v},{value:f[1],color:v})}var s=this._pieceList.slice();if(!s.length)s.push({interval:[-1/0,1/0]});else{var l=s[0].interval[0];l!==-1/0&&s.unshift({interval:[-1/0,l]}),l=s[s.length-1].interval[1],l!==1/0&&s.push({interval:[l,1/0]})}var h=-1/0;return _(s,function(f){var u=f.interval;u&&(u[0]>h&&o([h,u[0]],"outOfRange"),o(u.slice()),h=u[1])},this),{stops:i,outerColors:r}},e.type="visualMap.piecewise",e.defaultOption=xe(ht.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),e}(ht),Ir={splitNumber:function(n){var e=this.option,t=Math.min(e.precision,20),i=this.getExtent(),r=e.splitNumber;r=Math.max(parseInt(r,10),1),e.splitNumber=r;for(var a=(i[1]-i[0])/r;+a.toFixed(t)!==a&&t<5;)t++;e.precision=t,a=+a.toFixed(t),e.minOpen&&n.push({interval:[-1/0,i[0]],close:[0,0]});for(var o=0,s=i[0];o<r;s+=a,o++){var l=o===r-1?i[1]:s+a;n.push({interval:[s,l],close:[1,1]})}e.maxOpen&&n.push({interval:[i[1],1/0],close:[0,0]}),Xt(n),_(n,function(h,f){h.index=f,h.text=this.formatValueText(h.interval)},this)},categories:function(n){var e=this.option;_(e.categories,function(t){n.push({text:this.formatValueText(t,!0),value:t})},this),pe(e,n)},pieces:function(n){var e=this.option;_(e.pieces,function(t,i){B(t)||(t={value:t});var r={text:"",index:i};if(t.label!=null&&(r.text=t.label),t.hasOwnProperty("value")){var a=r.value=t.value;r.interval=[a,a],r.close=[1,1]}else{for(var o=r.interval=[],s=r.close=[0,0],l=[1,0,1],h=[-1/0,1/0],f=[],u=0;u<2;u++){for(var p=[["gte","gt","min"],["lte","lt","max"]][u],v=0;v<3&&o[u]==null;v++)o[u]=t[p[v]],s[u]=l[v],f[u]=v===2;o[u]==null&&(o[u]=h[u])}f[0]&&o[1]===1/0&&(s[0]=0),f[1]&&o[0]===-1/0&&(s[1]=0),o[0]===o[1]&&s[0]&&s[1]&&(r.value=o[0])}r.visual=R.retrieveVisuals(t),n.push(r)},this),pe(e,n),Xt(n),_(n,function(t){var i=t.close,r=[["<","≤"][i[1]],[">","≥"][i[0]]];t.text=t.text||this.formatValueText(t.value!=null?t.value:t.interval,!1,r)},this)}};function pe(n,e){var t=n.inverse;(n.orient==="vertical"?!t:t)&&e.reverse()}const Vr=Cr;var Or=function(n){P(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.doRender=function(){var t=this.group;t.removeAll();var i=this.visualMapModel,r=i.get("textGap"),a=i.textStyleModel,o=a.getFont(),s=a.getTextColor(),l=this._getItemAlign(),h=i.itemSize,f=this._getViewData(),u=f.endsText,p=mi(i.get("showLabel",!0),!u);u&&this._renderEndsText(t,u[0],h,p,l),_(f.viewPieceList,function(v){var c=v.piece,d=new lt;d.onclick=I(this._onItemClick,this,c),this._enableHoverLink(d,v.indexInModelPieceList);var g=i.getRepresentValue(c);if(this._createItemSymbol(d,g,[0,0,h[0],h[1]]),p){var m=this.visualMapModel.getValueState(g);d.add(new U({style:{x:l==="right"?-r:h[0]+r,y:h[1]/2,text:c.text,verticalAlign:"middle",align:l,font:o,fill:s,opacity:m==="outOfRange"?.5:1}}))}t.add(d)},this),u&&this._renderEndsText(t,u[1],h,p,l),_i(i.get("orient"),t,i.get("itemGap")),this.renderBackground(t),this.positionGroup(t)},e.prototype._enableHoverLink=function(t,i){var r=this;t.on("mouseover",function(){return a("highlight")}).on("mouseout",function(){return a("downplay")});var a=function(o){var s=r.visualMapModel;s.option.hoverLink&&r.api.dispatchAction({type:o,batch:ot(s.findTargetDataIndices(i),s)})}},e.prototype._getItemAlign=function(){var t=this.visualMapModel,i=t.option;if(i.orient==="vertical")return ze(t,this.api,t.itemSize);var r=i.align;return(!r||r==="auto")&&(r="left"),r},e.prototype._renderEndsText=function(t,i,r,a,o){if(i){var s=new lt,l=this.visualMapModel.textStyleModel;s.add(new U({style:nt(l,{x:a?o==="right"?r[0]:0:r[0]/2,y:r[1]/2,verticalAlign:"middle",align:a?o:"center",text:i})})),t.add(s)}},e.prototype._getViewData=function(){var t=this.visualMapModel,i=ft(t.getPieceList(),function(s,l){return{piece:s,indexInModelPieceList:l}}),r=t.get("text"),a=t.get("orient"),o=t.get("inverse");return(a==="horizontal"?o:!o)?i.reverse():r&&(r=r.slice().reverse()),{viewPieceList:i,endsText:r}},e.prototype._createItemSymbol=function(t,i,r){t.add(Ct(this.getControllerVisual(i,"symbol"),r[0],r[1],r[2],r[3],this.getControllerVisual(i,"color")))},e.prototype._onItemClick=function(t){var i=this.visualMapModel,r=i.option,a=r.selectedMode;if(a){var o=H(r.selected),s=i.getSelectedMapKey(t);a==="single"||a===!0?(o[s]=!0,_(o,function(l,h){o[h]=h===s})):o[s]=!o[s],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:o})}},e.type="visualMap.piecewise",e}(Oe);const zr=Or;function Rr(n){n.registerComponentModel(Vr),n.registerComponentView(zr),Re(n)}function Pr(n){Tt(Tr),Tt(Rr)}export{Pr as a,kr as b,Hr as i};
